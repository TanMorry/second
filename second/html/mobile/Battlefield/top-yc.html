<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta name="format-detection" content="telephone=no"/>
    <title>喵</title>
    <link href="../css/global.css" rel="stylesheet" type="text/css">
    <link href="../css/public.css" rel="stylesheet" type="text/css">
    <style type="text/css">
    </style>
    <script src="../js/jquery-2.2.4.min.js"></script>
    <script src="../js/obtainArguments.js"></script>
    <script>
        $().ready(function () {
            $('.btn-b').click(function(){
                $('.content').css({
                    "overflow-x":"hidden",
                    "overflow-y":"hidden"
                });
                $('.btn-y').find('i').removeClass('btn-up')
                $('.btn-y').find('span').removeClass('btn1-b-color')
                $('.top-btn1-y').removeClass('btn-block');
                $('.content-cover').show();
                if($(this).find('i').hasClass('btn-up')){
                    $(this).find("i").removeClass(' btn-up');
                    $(this).find('span').removeClass('btn1-b-color');
                    $('.top-btn1-b').removeClass('btn-block');
                    $('.content-cover').hide();
                    $('.content').css({
                        "overflow-x":"auto",
                        "overflow-y":"auto"
                    });
                }else{
                    $(this).find("i").addClass(' btn-up');
                    $(this).find('span').addClass('btn1-b-color');
                    $('.top-btn1-b').addClass('btn-block');
                    $('.content-cover').show();
                }
            });
            $('.btn-y').click(function(){
                $('.btn-b').find('i').removeClass('btn-up');
                $('.btn-b').find('span').removeClass('btn1-b-color');
                $('.top-btn1-b').removeClass('btn-block');
                $('.content').css({
                    "overflow-x":"hidden",
                    "overflow-y":"hidden"
                });
                $('.content-cover').show();
                if($(this).find('i').hasClass('btn-up')){
                    $(this).find("i").removeClass(' btn-up');
                    $(this).find('span').removeClass('btn1-b-color');
                    $('.top-btn1-y').removeClass('btn-block');
                    $('.content-cover').hide();
                    $('.content').css({
                        "overflow-x":"auto",
                        "overflow-y":"auto"
                    });
                }else{
                    $(this).find("i").addClass(' btn-up');
                    $(this).find('span').addClass('btn1-b-color');
                    $('.top-btn1-y').addClass('btn-block');
                    $('.content-cover').show();
                }
            });
            $('.content-cover').click(function(){
                $(this).hide();
                $('.btn-y,.btn-b').find('i').removeClass('btn-up');
                $('.btn-y,.btn-b').find('span').removeClass('btn1-b-color');
                $('.top-btn1-y,.top-btn1-b').removeClass('btn-block');
                $('.content').css({
                    "overflow-x":"auto",
                    "overflow-y":"auto"
                });
            });
            $('.top-btn1-b,.top-btn1-y').on('click', 'a', function(){
                $(this).addClass('btn1-b-color').siblings().removeClass('btn1-b-color');
                $('.content-cover').hide();
                $('.btn-y,.btn-b').find('i').removeClass('btn-up');
                $('.btn-y,.btn-b').find('span').removeClass('btn1-b-color');
                $('.content').css({
                    "overflow-x":"auto",
                    "overflow-y":"auto"
                });
                $('.top-btn1-y,.top-btn1-b').removeClass('btn-block');
                if($(this).parent().hasClass("top-btn1-b")){
                    $('.btn-b>span').text($(this).text())
                }else{
                    if($(this).parent().hasClass("top-btn1-y")){
                        $('.btn-y>span').text($(this).text())
                    }
                }
            });
            $('.direction_f').click(function(){
                $(this).toggleClass('direction_f_bg')
            })
        })
    </script>

</head>
<body>
<!-- 首页 -->
<section class="flex">
    <section class="header">
        <div class="header-bg normal">
            <div class="header-l"><a href="#"></a></div>
            <div class="header-c header-dz header_pad">原作名称</div>
            <div class="header-s"></div>
            <div class="header-r"><a href="#"></a></div>
        </div>
        <div class="btn" id="shaixuan">
            <div class="top-nav top-border">
                <a href="javascript:" class="top-btn1 btn-b" ><span>日榜</span><i class="down"></i></a>
                <a href="javascript:" class="top-btn1 btn-y"><span>全部类型</span ><i class="down"></i></a>
                <i href="javascript:" class="top-btn2" ><a class="direction_f" data-islatest="0"></a><span>只看上新</span></i>
            </div>
            <div class="top-btn1-b">
                <a href="javascript:" class="btn1-b-color" data-battleType="daycut">日榜</a>
                <a href="javascript:" data-battleType="weekcut">周榜</a>
                <a href="javascript:" data-battleType="monthcut">月榜</a>
            </div>
            <div class="top-btn1-y">
                <a href="javascript:" class="btn1-b-color" data-yzType="-1">全部类型</a>
                <a href="javascript:" data-yzType="0">仅本子</a>
                <a href="javascript:" data-yzType="1">仅周边</a>
            </div>
        </div>
    </section>
    <!-- 主体 -->
    <section class="content">
        <div class="content-cover"></div>
        <div class="sale-item3 part">
            <ul class="sale-ones tie clearfix" id="matterList">
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<i class="up-one up-one-a sale-i"></i>-->
                            <!--<a href="#">-->
                            <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<i class="up-one up-one-b sale-i"></i>-->
                            <!--<a href="#">-->
                            <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<i class="up-one up-one-c sale-i"></i>-->
                            <!--<a href="#">-->
                            <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<a href="#">-->
                                <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<a href="#">-->
                                <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li>-->
                    <!--<div class="sale-ones-front tie">-->
                        <!--<p class="sale-of-img">-->
                            <!--<a href="#">-->
                                <!--<img src="../img/test/item1.png"></a>-->
                        <!--</p>-->
                        <!--<p class="sale-of-name">测试</p>-->
                        <!--<p class="sale-of-text">原作:伪装者</p>-->
                        <!--<p class="sale-of-text">销量:<span>5688</span></p>-->
                        <!--<p class="sale-of-price">￥100.00</p>-->
                    <!--</div>-->
                <!--</li>-->

            </ul>
        </div>

    </section>
    <section class="footer">
        <div class="page horizontal-center">
            <a class="page-up" href="#" id="page-up" onclick="page(this)" data-val="prev"></a>
            <i class="auto-width"><!-- auto width --></i>
            <input class="page-write" type="text" id="skipPage">
            <a class="page-go" href="#" id="go" onclick="page(this)" data-val="GO">GO</a>
            <span class="page-count"><b id="current"></b><i>/</i><b id="totalPage"></b></span>
            <i class="auto-width"><!-- auto width --></i>
            <a class="page-down" href="#" id="page-down" onclick="page(this)" data-val="next"></a>
        </div>
    </section>
</section>
</body>
</html>
<script>
    var urlObj = new Arguments();
    var urlParam = urlObj.Request();
    var battleType = 'daycut';//默认日榜
    var yzType = -1;//默认全部类型
    var islatest = 0;//最新上新默认没勾选
    var cpname = decodeURI(urlParam.name);
    $(function(){
        ajax_data()
        shaixuan()
    })

    function ajax_data()
    {
        var url = '/tongrenmiao/index.php?g=Mall&=Index&a=battleField_detail';
        $.ajax({
            url:url,
            data:{'name':cpname,'battleType':battleType,'yzType':yzType,'islatest':islatest},
            type:'get',
            dataType:'json',
            beforeSend:function()
            {

            },
            success:function(res)
            {
                if(res.Info != "")
                {
                    handleHtml(res.Info)
                }
                else
                {
                    alert(1)
                }
            },
            error:function()
            {

            }
        })
    }

    function shaixuan()
    {
        var $a = $("#shaixuan").find('a:gt(1)')
        var num = $a.length;
        for(var i=0; i<num; i++)
        {
            $($a[i]).click(function(){
                if(typeof ($(this).attr('data-battleType')) != 'undefined')
                {
                    battleType = $(this).attr('data-battleType');
                }
                else if(typeof ($(this).attr('data-yzType')) != 'undefined')
                {
                    yzType = $(this).attr('data-yzType');
                }
                else if(typeof ($(this).attr('data-islatest')) != 'undefined')
                {
                    if($(this).hasClass('direction_f_bg'))
                    {
                        $(this).attr('data-islatest','1');
                        islatest = 1;
                    }
                    else
                    {
                        $(this).attr('data-islatest','0');
                        islatest = 0;
                    }
                }
                ajax_data();
            })
        }
    }

    function handleHtml(list)
    {
        var str = '';
        $.each(list,function(k,v){
            str += '<li>\
                        <div class="sale-ones-front tie">\
                            <p class="sale-of-img">\
                                <i class="up-one up-one-a sale-i"></i>\
                                <a href="#">\
                                <img src="../img/test/item1.png"></a>\
                            </p>\
                            <p class="sale-of-name">'+v.name+'</p>\
                            <p class="sale-of-text">原作:'+v.original+'</p>\
                            <p class="sale-of-text">销量:<span>'+v.sales+'</span></p>\
                            <p class="sale-of-price">￥'+v.price+'</p>\
                        </div>\
                    </li>';
        })
        $("#matterList").html(str);
    }
</script>